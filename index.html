<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saber Teacher Dashboard - Enhanced</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“š</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="dashboard-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 class="brand-logo">Saber</h2>
                <button id="toggle-sidebar-btn" class="icon-button mobile-only" aria-label="Toggle Sidebar">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-button active" data-view="class-session">
                    <i class="fas fa-chalkboard-user"></i> Class Session
                </button>
                <button class="nav-button" data-view="settings">
                    <i class="fas fa-cog"></i> Settings
                </button>
                </nav>

            <div class="sidebar-session-controls" id="session-controls">
                <h3>Session Controls</h3>
                <button id="start-session-btn" class="button primary"><i class="fas fa-play"></i> Start Session</button>
                <button id="end-session-btn" class="button danger hidden"><i class="fas fa-stop"></i> End Session</button>
                <div id="session-timer" class="session-timer hidden">
                    <i class="fas fa-clock"></i> Session Time: <span id="timer-display">00:00:00</span>
                </div>
            </div>

             <div class="sidebar-actions" id="global-actions">
                 <h3>Global Actions</h3>
                 <p class="action-info">Apply to <strong id="selection-count">0</strong> selected students (or ALL if none selected)</p>
                 <button id="lock-selected-btn" class="button action-btn"><i class="fas fa-lock"></i> Lock Screens</button>
                 <button id="unlock-selected-btn" class="button action-btn"><i class="fas fa-unlock"></i> Unlock Screens</button>
                 <button id="announce-selected-btn" class="button action-btn"><i class="fas fa-bullhorn"></i> Send Announcement</button>
                 <button id="open-tab-selected-btn" class="button action-btn"><i class="fas fa-external-link-alt"></i> Open Tab</button>
                 <button id="apply-blocklist-selected-btn" class="button action-btn"><i class="fas fa-ban"></i> Apply Blocklist</button>
             </div>

            <div class="sidebar-footer">
                <div id="connection-status" class="status-indicator disconnected">
                    <i class="fas fa-circle"></i> Disconnected
                </div>
                 <span id="student-count-display">0 Students</span>
            </div>
        </aside>

        <main class="main-content" id="main-content">
            <section id="view-class-session" class="dashboard-view active">
                <header class="main-header">
                    <h1>Class Session</h1>
                    <div class="header-controls">
                        <button id="select-all-btn" class="button outline"><i class="fas fa-check-double"></i> Select All</button>
                        <button id="deselect-all-btn" class="button outline"><i class="fas fa-times"></i> Deselect All</button>
                        </div>
                </header>
                <div class="students-grid-container" id="students-grid-container">
                    <div id="students-grid">
                        <p id="placeholder-message" class="placeholder">Start a session and wait for students to connect...</p>
                    </div>
                </div>
            </section>

            <section id="view-settings" class="dashboard-view hidden">
                <header class="main-header">
                    <h1>Settings</h1>
                </header>
                <div class="settings-container">
                     <div class="setting-card">
                        <h3><i class="fas fa-list-check"></i> Blocklist Management</h3>
                        <p>Define URL patterns to block for students. Apply globally or to selected students from the sidebar.</p>
                        <label for="blocklist-editor">Blocked URL Patterns (one per line):</label>
                        <textarea id="blocklist-editor" rows="8" placeholder="e.g., *://*.coolmathgames.com/*&#10;*://*.youtube.com/*"></textarea>
                        <button id="save-blocklist-btn" class="button primary"><i class="fas fa-save"></i> Save & Apply Blocklist</button>
                     </div>
                    <div class="setting-card">
                         <h3><i class="fas fa-camera"></i> Screenshot Interval</h3>
                         <p>Set how often screenshots are taken for students (minimum 1000ms). Applied individually or to selected students.</p>
                         <label for="screenshot-interval-input">Interval (milliseconds):</label>
                         <input type="number" id="screenshot-interval-input" value="5000" min="1000" step="1000">
                         <button id="apply-interval-selected-btn" class="button primary"><i class="fas fa-check"></i> Apply Interval to Selected</button>
                    </div>
                     </div>
            </section>
        </main>
    </div>

    <div id="modal-overlay" class="modal-overlay hidden"></div>

    <div id="announcement-modal" class="modal hidden">
        <button class="modal-close-btn" data-modal-id="announcement-modal">&times;</button>
        <h3><i class="fas fa-bullhorn"></i> Send Announcement</h3>
        <p>Send a message to selected students.</p>
        <label for="announcement-message">Message:</label>
        <textarea id="announcement-message" rows="3" placeholder="Enter your announcement..."></textarea>
        <label for="announcement-duration">Duration (seconds):</label>
        <input type="number" id="announcement-duration" value="7" min="1">
        <div class="modal-actions">
            <button id="send-announcement-confirm-btn" class="button primary">Send</button>
            <button class="button outline modal-cancel-btn" data-modal-id="announcement-modal">Cancel</button>
        </div>
    </div>

    <div id="open-tab-modal" class="modal hidden">
        <button class="modal-close-btn" data-modal-id="open-tab-modal">&times;</button>
        <h3><i class="fas fa-external-link-alt"></i> Open Tab</h3>
        <p>Open a new tab for selected students.</p>
        <label for="open-tab-url">URL:</label>
        <input type="url" id="open-tab-url" placeholder="https://example.com">
        <div class="modal-actions">
            <button id="open-tab-confirm-btn" class="button primary">Open</button>
            <button class="button outline modal-cancel-btn" data-modal-id="open-tab-modal">Cancel</button>
        </div>
    </div>

    <div id="notification-area" class="notification-area"></div>

    <script src="script.js"></script>
</body>
</html>
